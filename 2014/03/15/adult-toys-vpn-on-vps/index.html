<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>大人的玩具 : VPN on VPS | Hex Fantastic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="##工程師的玩具有時候做工程師做到某些地步的時候，很多東西都會想自己翻出來玩玩，比方說自己也想要架個站啦，或者說自己希望有一個自己的git server啦等等。很多人或多或少都會去弄一個VPS來玩玩，一個月也才5塊10塊USD就能有一組自己用的server，可以在上面跑自己的blog，或者自己架個git，自己架個VPN…等等。當然，我自己來講的話最大的目的是要有一個穩定的server來跑自己的實驗">
<meta property="og:type" content="article">
<meta property="og:title" content="大人的玩具 : VPN on VPS">
<meta property="og:url" content="http://yoursite.com/2014/03/15/adult-toys-vpn-on-vps/index.html">
<meta property="og:site_name" content="Hex Fantastic">
<meta property="og:description" content="##工程師的玩具有時候做工程師做到某些地步的時候，很多東西都會想自己翻出來玩玩，比方說自己也想要架個站啦，或者說自己希望有一個自己的git server啦等等。很多人或多或少都會去弄一個VPS來玩玩，一個月也才5塊10塊USD就能有一組自己用的server，可以在上面跑自己的blog，或者自己架個git，自己架個VPN…等等。當然，我自己來講的話最大的目的是要有一個穩定的server來跑自己的實驗">
<meta property="og:updated_time" content="2017-05-29T22:29:26.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大人的玩具 : VPN on VPS">
<meta name="twitter:description" content="##工程師的玩具有時候做工程師做到某些地步的時候，很多東西都會想自己翻出來玩玩，比方說自己也想要架個站啦，或者說自己希望有一個自己的git server啦等等。很多人或多或少都會去弄一個VPS來玩玩，一個月也才5塊10塊USD就能有一組自己用的server，可以在上面跑自己的blog，或者自己架個git，自己架個VPN…等等。當然，我自己來講的話最大的目的是要有一個穩定的server來跑自己的實驗">
  
    <link rel="alternate" href="/atom.xml" title="Hex Fantastic" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hex Fantastic</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">這世界有點無聊，找點架吵吧!</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-adult-toys-vpn-on-vps" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/03/15/adult-toys-vpn-on-vps/" class="article-date">
  <time datetime="2014-03-15T11:46:00.000Z" itemprop="datePublished">2014-03-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      大人的玩具 : VPN on VPS
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>##工程師的玩具<br>有時候做工程師做到某些地步的時候，很多東西都會想自己翻出來玩玩，比方說自己也想要架個站啦，或者說自己希望有一個自己的git server啦等等。很多人或多或少都會去弄一個VPS來玩玩，一個月也才5塊10塊USD就能有一組自己用的server，可以在上面跑自己的blog，或者自己架個git，自己架個VPN…等等。當然，我自己來講的話最大的目的是要有一個穩定的server來跑自己的實驗性專案，可是開在家裡面的電腦的話一個月電費就要近千啦(請參考<a href="http://cablechen.pixnet.net/blog/post/26911720" target="_blank" rel="external">這篇文章</a>)。加上還要搞個堪用的ADSL/光世代，平常也沒用的到的話，那這個「玩具」的開銷顯然是相當可觀的。</p>
<p>這樣算算，一個月為了這個Hobby，大概至少要吃掉1張小朋友不止。當然電腦是家裡都有的，網路大家也都是吃到飽的，不過要24hr開機加上當Server需要的頻寬，造成多出來的成本每個月又是另外一回事了，加上ip不固定要弄個淺顯易懂的網域名稱也很麻煩，怎麼算實在都不太應該把家裡變成機房才對。</p>
<p>所以，當然我們就會選擇在外面租一台Server。一台實體Server要價是相當可觀的，不過由於最近流行的雲端，虛擬balabala這些就算懂也不知道怎麼解釋的概念，現在已經不再是一租就得租一台server放在機房吹冷氣的時代了，現在流行的概念是<a href="http://zh.wikipedia.org/wiki/虚拟专用服务器" target="_blank" rel="external">VPS</a>。我們運氣不錯，流行通常也是「平價」的另外一種說法（太貴要怎麼流行起來啦！），所以我們就來看看這個東西要怎麼架，大概口袋要多深才玩得起這種大人的玩具。</p>
<p>##為什麼要VPS?<br>其實這理由就跟「為什麼你會想要擱一台Server在家裡面」是完全一樣的道理。會想要在外面access檔案啦，需要git repo啦(<a href="https://github.com" target="_blank" rel="external">github</a>一個月最便宜的方案要7塊錢，我知道只要全public是免費，甚至<a href="https://bitbucket.com" target="_blank" rel="external">bitbucket</a>還可以讓你有免費的private project…不過不是本文要提的重點)，也許你需要VPN啦，你需要一個server來實驗一些東西啦…等等。</p>
<p>簡單的說，你需要一個固定的ip，以及可以隨時打開關閉的一台主機對吧。像我自己的話，我需要一台Bugzilla跟一台repo+CI做自己的專案，所以我會去找一台VPS來做這件事情。有的人可能需要架一個Minecraft伺服器（開在家裡好貴的，真的），這些都足以構成「需要一個固定ip，以及一台24hr開機的主機」的條件。</p>
<p>當然，如果只是想要一個php/cgi架站空間，那有更便宜的選擇。我想這種跟VPS需求已經<a href="http://gordon168.net/shared-hosting-and-vps-and-delicated-hosting.html" target="_blank" rel="external">很多人</a>寫過<a href="http://www.taki.com.tw/blog/options-comparing-dedicated-servers-cloud-servers-and-vps/" target="_blank" rel="external">不少文章</a>來<a href="http://tfeng.org/?p=4526" target="_blank" rel="external">探討這個</a>了。我比較懶，沒辦法寫的那麼圖文並茂，所以就請各位去翻翻這些文章了 =P。不過要稍微做點補充的是，其實並不是所有的VPS都是基於該文章說的<a href="">OpenVZ</a>以及<a href="">Xen</a>，<a href="http://www.parallels.com/products/automation/old/modules/vps/" target="_blank" rel="external">Parallels</a>自己也用了自家完全獨立的VPS技術，VMWare自己也有一套專屬的<a href="https://www.vmware.com/pdf/desktop/vmware-kvm.pdf" target="_blank" rel="external">Sphere KVM</a>。</p>
<p>##所以VPS怎麼選?<br>很多人一定第一個會推薦口碑最不錯的<a href="https://www.linode.com" target="_blank" rel="external">Linode</a>，不過我推薦的比較不同，我推薦的是可以讓你免費玩一年試著用看看的<a href="http://aws.amazon.com/ec2/" target="_blank" rel="external">Amazon EC2</a>。我在後面會聊聊我以前到現在有接觸過的VPS。</p>
<p>不是說我不推薦國貨，不過台灣的VPS是相當昂貴的，同樣的規格幾乎是外國的一倍半到兩倍的價格。除非這個VPS是以要服務台灣客戶為主，不然我並不會很推薦使用台灣的VPS。這篇文章要介紹的是玩具，不是生財工具啊…(遠目)</p>
<ul>
<li><p>###<a href="https://www.linode.com" target="_blank" rel="external">Linode</a></p>
<ul>
<li>這應該是目前最多人的選擇。穩定，客服好，加上有降過一次價（因為被某駭客團體打趴了一次，詳細故事請看<a href="http://blog.xdite.net/posts/2013/05/08/linode-hacked-htp" target="_blank" rel="external">這篇文章</a>)以後價格好了不少，算是一個相當穩定好用的VPS。真的要說缺點的話，就是他的價格是20USD/mo起跳，而這USD20給的規格其實也差不多就是做足了USD20該有的規格。20USD並不是什麼大錢，老實講。但是以一個起步用的玩玩看的實驗心態來說，這價格仍然是偏高了一點。</li>
<li>但是說真的，要是哪天這玩具玩的大了一點的話，這是個值得考慮的對象。</li>
<li>另外，他有提供功能算是很ok的Android/iPhone apps。</li>
</ul>
</li>
<li><p>###<a href="http://aws.amazon.com/ec2/" target="_blank" rel="external">Amazon Web Service - EC2</a></p>
<ul>
<li>由於他有提供新使用者一整年的t1.micro free tier usage，白話的說，就是一整年的免費 – 雖給的資源很小很陽春，但是如果你不知道你要一個VPS能幹嘛，你可以拿這個去玩一年玩玩看！至少裝個VPN(下面會教學)看看。由於這點的關係，這完全成為了新手的首選！雖然他給的規格實在是很可憐，可是一開始我相信絕大多數人連這可憐的性能都用不滿XD。再怎麼陽春至少git也跑得起來，VPN也沒有問題，阿帕契…er…我不太確定他能不能完整的裝起LAMP，不過我想對大多數人來講，都是很夠的。要注意的是，他「免費」要認的東西是id，信用卡號以及登錄電話都要是新的才會給你免費。<a href="http://blog.rx836.tw/blog/first-amazon-web-services/" target="_blank" rel="external">有人寫了篇文章</a>來介紹怎麼免費註冊EC2一年。<a href="http://blog.soft.idv.tw/?p=823" target="_blank" rel="external">這邊</a>跟<a href="http://blog.soft.idv.tw/?p=824" target="_blank" rel="external">這邊</a>也有很詳細說明怎麼申請以及使用免費的EC2。</li>
<li>不過這個連跑Minecraft server都很勉強，記憶體要壓到一半才能跑起來，但是還是能用的！真的！</li>
<li>值得一提的是，由於他們家一些超級powerful的服務的關係，如果你需要用到他們的S3阿，RDS等等的話，用他們家的EC2是設定最少最方便的，幾乎拷貝貼上就能用了。另外他們的Free tier usage裡面包含的服務不止EC2，可以順便玩玩看他們其他的服務比方說CloudFront等等。</li>
<li>不過事實上它幾乎是僅次於Krypt以後最貴的了… 但是也是少數有提供以小時計費的公司，所以網站掛點緊急開一個EC2來備援是很常見的做法。</li>
</ul>
</li>
<li><p>###<a href="https://www.digitalocean.com" target="_blank" rel="external">DigitalOcean</a></p>
<ul>
<li>這家算是我覺得平價VPS裡面最適合初學者的首選。價格屬於相當低價的範圍，而且計費是以小時/月雙軌的方法計費，開instance又很快，幾乎是一分鐘之內就開起來了，賣點還有包含他們引以自豪的SSD。如果真的喜歡控制成本怕多花錢的來講，這家這點真的是無話可說的讚。</li>
<li>不過說缺點也不算少。CPU來講這家給的是比較小氣的，這點尤其在作CI是很明顯看得出來。流量1T(5USD/mo)/2T(10USD/mo)是用不太完啦，不過有聽說有人因為BT等東西被警告的。其實對於內容控管是稍微嚴格一點，像是pornography等等，這家很像學生宿舍，便宜，但是有些東西會管。不過我想對大多數人來講，他們管的其實都跟我們再做的事情是擦不上邊的 =P</li>
<li>我目前選擇的是這家。如果願意從我這邊referal的話，請點<a href="https://www.digitalocean.com/?refcode=b5c2c6a0bfdf" target="_blank" rel="external">這個連結</a>。這個小段落關於DigitalOcean的link是沒有藏Referral code的，如果不太喜歡Referral的話可以「安全」的點這個小段落最上面DigitalOcean的介紹link :3</li>
</ul>
</li>
<li><p>###<a href="http://www.photonvps.com" target="_blank" rel="external">Photon</a></p>
<ul>
<li><a href="http://tfeng.org/?p=4539" target="_blank" rel="external">這位老兄比較圖文並茂一點</a>，所以就直接借用他的來介紹了。這家在對岸很多人推薦，也很穩，價格又很ok，所以很多人買來直接當VPN來玩 XD</li>
</ul>
</li>
<li><p>###<a href="http://directspace.net" target="_blank" rel="external">DirectSpace</a></p>
<ul>
<li>這家有一個便宜到非常恐怖至極的15USD/yr(對，一年才15塊錢)的超經濟方案（而且規格還略比EC2免費等級還好一點）。但是好像…買不到了囧。如果買的到的話這絕對是跟EC2並列的超初心者首選方案啊。應該不是饑餓行銷或者幌子，而是因為他們網站最近設備也在升級，結果就是現在很多方案，以及幾乎所有的Dedicated Server都缺貨。</li>
<li>C/P比相當不錯，不止一個人稱讚。10USD/mo可以給你到2G記憶體加上3vCPU(不過不知道真實計算能力怎樣)，這規格說真的市面上很難有人給的出來，而且我朋友是他的老客戶，也說這算頗穩了。</li>
<li>但是，他們實在是懶到一個境界 – 標準開一個Software VPS要開一整天還開不起來，買下去要給你pending個兩三天，信也常常三兩天才回，非常的放羊吃草 XD。所以我買了下去結果開到現在VPS還在pending status，兩天了… orz 所以我就退掉先了，他們有三天無條件退款機制 – 可是兩天VPS都還沒開起來是哪招…</li>
</ul>
</li>
<li><p>###<a href="http://www.krypt.com/cloud/" target="_blank" rel="external">Krypt</a></p>
<ul>
<li>Krypt基本上提供的並不是玩具等級的服務，他擁有非常完善的(以及異常昂貴的)全面零時備援以及高得驚人的頻寬(不過很妙的是他給的免費流量挺小氣的–以他的價格來講)，而且他的vCPU給的運算速度也幾乎是最高的。不過，商務來講我會選EC2或者Linode，玩具來講我會選DigitalOcean或者Photon…恩…</li>
</ul>
</li>
</ul>
<p>##不止VPS…還要再多一個Domain Name<br>基本上VPS Vender都會提供一個固定的ip給你，而大家應該會希望有一個自己的Domain Name吧。我自己的話是買了一個rayer.idv.tw, 這不貴，租三年才1080。值得注意的是，他租一年400，兩年800，第三年卻只要280，第四年又突然變高，所以租三年是最划算的。</p>
<p>至於怎麼租怎麼設定，請看<a href="http://sofree.cc/domain-name/" target="_blank" rel="external">這裡</a>。如果想租國際等級的網域如.com的話，普通都會建議去<a href="https://www.godaddy.com" target="_blank" rel="external">GoDaddy</a>去註冊，價格就請自己去看，都不會太貴，甚至比租.idv.tw還便宜點。</p>
<p>不過hinet DNS update得頗快，我用的是google的DNS(8.8.8.8/8.8.4.4)，不過基本上Hinet Domain註冊好以後ip也bind好以後5分鐘之內就指的到了，而GoDaddy常常需要花2小時到一天不等。不過，hinet雖然快而且不貴，但是由於它並不提供CNAME修改（需要你自己去架一個DNS，這不算難，別忘了我們可是有一台無所不能的VPS!不過就是麻煩）…所以有這需求的話其實其他家有更好的服務。但是，如果單純只是要價格ok更新速度又快（誰會一天到晚沒事改IP我也很好奇），hinet是首選。</p>
<p>##動手來搞一個VPN…傻瓜版本<br>所以我們也買好VPS了，準備開始開工吧！我自己選擇的是CentOS 6.x的64bit版本。這邊版本喜好就見仁見智了，不過我已CentOS來當例子，架一個最普通的VPN試試看！在古早以前，pptpd的安裝是一個很麻煩的事情，不過有位老兄用script把他徹底簡化:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo yum install git</div><div class="line">cd /opt </div><div class="line">sudo git clone git://github.com/drewsymo/VPN.git</div><div class="line">sudo cd VPN &amp;&amp; bash vpn-setup-vanilla.sh</div></pre></td></tr></table></figure>
<p>就那麼簡單。不過，如果你的VPS供應商用的是OpenVZ的話，可能要多一個步驟。如何知道你供應商用的是不是OpenVZ呢？很簡單，<code>ifconfig</code>下去看有沒有veth0或者venet0這個接口就對了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo iptables -t nat -A POSTROUTING -j SNAT --to-source x.x.x.x</div></pre></td></tr></table></figure>
<p>其中x.x.x.x就是該接口的ip位置。</p>
<p>這樣預設裝好以後只有一組帳號叫做myuser/mypass。帳號密碼設定檔其實是放在/etc/ppp/chap-secrets，我們cat一下看看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo cat /etc/ppp/chap-secrets</div><div class="line"># Secrets for authentication using CHAP</div><div class="line"># client	server	secret			IP addresses</div><div class="line">myuser pptpd mypass *</div></pre></td></tr></table></figure>
<p>簡單啦，就在下面加入&lt;你的id&gt; pptpd &lt;你的密碼&gt; *就成啦。</p>
<p>##動手玩玩看這個VPN吧!<br>&lt;需要抓圖，待續&gt; 不過說真的大家都知道怎麼用VPN，應該也不太需要這一段了吧 =P</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/03/15/adult-toys-vpn-on-vps/" data-id="cj3b7m8ip000i5osi8dydl9hm" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/03/21/java-8-far-reaching-stream-with-lambda/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Récent</strong>
      <div class="article-nav-title">
        
          Java 8 : 影響深遠的Stream, Lambda以及Functional Interfaces
        
      </div>
    </a>
  
  
    <a href="/2014/02/01/constructor-call-another-constructor-w-c-11/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ancien</strong>
      <div class="article-nav-title">Constructor call another Constructor w/ C++11</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">February 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">January 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">August 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/02/03/most-vexing-parsingc/">Most Vexing Parsing(C++)</a>
          </li>
        
          <li>
            <a href="/2015/08/23/markdown-text-color-support/">Markdown文字色彩支援</a>
          </li>
        
          <li>
            <a href="/2015/07/26/create-your-own-pgp-digital-signature/">創造一個自己的PGP電子簽章</a>
          </li>
        
          <li>
            <a href="/2015/06/15/sourceforge-bundled-third-party-software-causes-serious-disputes/">SourceForge綑綁第三方軟體引發嚴重爭議</a>
          </li>
        
          <li>
            <a href="/2015/04/12/oauth-with-android/">舊文回收:OAuth with Android</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Rayer<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>